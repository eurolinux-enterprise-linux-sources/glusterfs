From 5ac2f333c2286732c7afc3228992f5e5eb32cc92 Mon Sep 17 00:00:00 2001
From: Atin Mukherjee <amukherj@redhat.com>
Date: Mon, 21 Mar 2016 17:07:00 +0530
Subject: [PATCH 11/26] glusterd/spec: fixing autogen issue

Backport of https://code.engineering.redhat.com/gerrit/#/c/59463/

Because of the incorrect build section, autogen.sh wasn't re-run during the rpm
build process. The `extras/Makefile.in` was not regenerated with the changes
made to `extras/Makefile.am` in the firewalld patch. This meant that
`extras/Makefile` was generated without the firewalld changes. So the firewalld
config wasn't installed during `make install` and rpmbuild later failed when it
failed to find `/usr/lib/firewalld/glusterfs.xml`

Label: DOWNSTREAM ONLY

BUG: 1319625
>Reviewed-on: https://code.engineering.redhat.com/gerrit/59463

Change-Id: I498bcceeacbd839640282eb6467c9f1464505697
Signed-off-by: Atin Mukherjee <amukherj@redhat.com>
Reviewed-on: https://code.engineering.redhat.com/gerrit/70343
Reviewed-by: Milind Changire <mchangir@redhat.com>
---
 glusterfs.spec.in |    4 ----
 1 files changed, 0 insertions(+), 4 deletions(-)

diff --git a/glusterfs.spec.in b/glusterfs.spec.in
index d1d274b..b675444 100644
--- a/glusterfs.spec.in
+++ b/glusterfs.spec.in
@@ -582,14 +582,10 @@ This package provides the translators needed on any GlusterFS client.
 %setup -q -n %{name}-%{version}%{?prereltag}
 
 %build
-# For whatever reason, install-sh is sometimes missing. When this gets fixed,
-# there is no need to run ./autogen or have a BuildRequires for automake.
-[ -e 'install-sh' -o -e 'install.sh' ] || ./autogen.sh
 %if ( 0%{?rhel} && 0%{?rhel} < 6 )
 CFLAGS=-DUSE_INSECURE_OPENSSL
 export CFLAGS
 %endif
-%configure \
 ./autogen.sh && %configure \
         %{?_with_cmocka} \
         %{?_with_tmpfilesdir} \
-- 
1.7.1

